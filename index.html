<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Matrix Chat</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/alpinejs" defer></script>
</head>
<body class="bg-gray-100 flex items-center justify-center h-screen">
  <div x-data="chatApp()" 
       :class="{'w-96 h-[600px]': accessToken, 'w-96 h-96': !accessToken}"
       class="bg-white p-6 rounded shadow-md transition-all duration-500">

    <!-- –§–æ—Ä–º–∞ –ª–æ–≥—ñ–Ω—É -->
    <template x-if="!accessToken">
      <div>
        <h2 class="text-xl font-bold mb-4">–õ–æ–≥—ñ–Ω</h2>
        <input x-model="username" placeholder="Username"
               class="border p-2 w-full mb-2 rounded" />
        <input x-model="password" type="password" placeholder="Password"
               class="border p-2 w-full mb-2 rounded" />
        <button @click="login()" class="bg-blue-500 text-white p-2 w-full rounded hover:bg-blue-600 transition">
          –£–≤—ñ–π—Ç–∏
        </button>
        <p x-text="error" class="text-red-500 mt-2"></p>
      </div>
    </template>

    <!-- –ü–∞–Ω–µ–ª—å –ø—ñ—Å–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó -->
    <template x-if="accessToken">
      <div>
        <h1 class="text-green-600 text-xl font-bold text-center mb-2">
          –í–∏ —É—Å–ø—ñ—à–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑—É–≤–∞–ª–∏—Å—å
        </h1>
        <p class="text-gray-700 text-center mb-4">User ID: <span x-text="userId"></span></p>
        
        <!-- –†–µ–∑—é–º–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ -->
        <div class="bg-gray-50 p-4 rounded shadow mb-4">
          <h3 class="text-lg font-semibold mb-2">–ú–∞—Ä—ñ—è –ë–æ—Ä–æ–∑–Ω—é–∫</h3>
          <p><strong>–ü—Ä–æ—Ñ–µ—Å—ñ—è:</strong> –ö—É—Ä—Å–∞–Ω—Ç</p>
          <p><strong>–ù–∞–≤–∏—á–∫–∏:</strong> HTML, CSS,  JavaScript</p>
          <p><strong>–î–æ—Å–≤—ñ–¥:</strong> –†–æ–±–æ—Ç–∞ –Ω–∞–¥ –Ω–∞–≤—á–∞–ª—å–Ω–∏–º–∏ –ø—Ä–æ—î–∫—Ç–∞–º–∏</p>
          <p><strong>–ö–æ–Ω—Ç–∞–∫—Ç–∏:</strong> email@example.com</p>
        </div>

        <button @click="logout()" class="bg-gray-400 text-white p-2 w-full rounded hover:bg-gray-500 transition">
          –í–∏–π—Ç–∏
        </button>
      </div>
    </template>
  </div>

  <script>
    function chatApp() {
      return {
        username: '@mariaiiaia34:matrix.org', // —Ç–≤—ñ–π Matrix –∞–∫–∞—É–Ω—Ç
        password: '',
        accessToken: '',
        userId: '',
        error: '',

        async login() {
          try {
            let user = this.username.replace('@', '').replace(':matrix.org', '');

            const res = await fetch('https://matrix.org/_matrix/client/v3/login', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                type: 'm.login.password',
                user: user,
                password: this.password
              })
            });

            const data = await res.json();

            if (data.access_token) {
              this.accessToken = data.access_token;
              this.userId = data.user_id;
              this.error = '';
            } else {
              this.error = '–ù–µ–≤—ñ—Ä–Ω–∏–π –ª–æ–≥—ñ–Ω –∞–±–æ –ø–∞—Ä–æ–ª—å'; // üîπ –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—è
              console.error(data);
            }
          } catch (e) {
            this.error = '–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –≤—Ö–æ–¥—É';
            console.error(e);
          }
        },

        logout() {
          this.accessToken = '';
          this.username = '@mariaiiaia34:matrix.org';
          this.password = '';
          this.userId = '';
          this.error = '';
        }
      }
    }
  </script>
</body>
</html>
